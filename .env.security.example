# ============================================================================
# INTERCEPTOR SECURITY CONFIGURATION
# ============================================================================
# This file contains security-related environment variables
# Copy to .env.local and fill in your actual values
# NEVER commit this file to version control
# ============================================================================

# ============================================================================
# ENCRYPTION KEYS
# ============================================================================
# Generate a new encryption key using:
# node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"
ENCRYPTION_KEY=your_32_byte_hex_key_here

# Encryption algorithm (do not change)
ENCRYPTION_ALGORITHM=aes-256-gcm

# ============================================================================
# CLOUDINARY CONFIGURATION
# ============================================================================
# Get these from https://cloudinary.com/console
CLOUDINARY_CLOUD_NAME=your_cloud_name
CLOUDINARY_API_KEY=your_api_key
CLOUDINARY_API_SECRET=your_api_secret

# ============================================================================
# SUPABASE CONFIGURATION
# ============================================================================
# Get these from https://supabase.com
VITE_SUPABASE_URL=https://your-project.supabase.co
VITE_SUPABASE_ANON_KEY=your_anon_key
SUPABASE_SERVICE_ROLE_KEY=your_service_role_key

# ============================================================================
# DATABASE CONFIGURATION
# ============================================================================
# Supabase PostgreSQL connection string
DATABASE_URL=postgresql://user:password@host:5432/database

# ============================================================================
# AUTHENTICATION
# ============================================================================
# JWT secret for token signing
JWT_SECRET=your_jwt_secret_key_here

# JWT expiration time
JWT_EXPIRATION=24h

# ============================================================================
# SECURITY SETTINGS
# ============================================================================
# Bcrypt salt rounds (higher = more secure but slower)
BCRYPT_SALT_ROUNDS=10

# Session timeout in minutes
SESSION_TIMEOUT=30

# Maximum file size for uploads (in bytes)
MAX_FILE_SIZE=524288000  # 500MB

# ============================================================================
# AUDIT LOGGING
# ============================================================================
# Enable audit logging
ENABLE_AUDIT_LOGGING=true

# Audit log retention in days
AUDIT_LOG_RETENTION_DAYS=90

# ============================================================================
# API SECURITY
# ============================================================================
# API rate limiting (requests per minute)
RATE_LIMIT_REQUESTS=100
RATE_LIMIT_WINDOW_MS=60000

# CORS allowed origins (comma-separated)
CORS_ALLOWED_ORIGINS=http://localhost:3000,https://yourdomain.com

# ============================================================================
# ENCRYPTION KEY ROTATION
# ============================================================================
# Enable automatic key rotation
ENABLE_KEY_ROTATION=false

# Key rotation interval in days
KEY_ROTATION_INTERVAL_DAYS=90

# ============================================================================
# LOGGING
# ============================================================================
# Log level (debug, info, warn, error)
LOG_LEVEL=info

# Enable detailed security logging
SECURITY_LOG_ENABLED=true

# ============================================================================
# DEVELOPMENT/PRODUCTION
# ============================================================================
# Environment (development, staging, production)
NODE_ENV=production

# Enable debug mode (never in production)
DEBUG=false

# ============================================================================
# NOTES
# ============================================================================
# 1. Generate ENCRYPTION_KEY using the command above
# 2. Store all keys securely (use a secrets manager in production)
# 3. Rotate ENCRYPTION_KEY periodically
# 4. Never commit .env files to version control
# 5. Use different keys for different environments
# 6. Enable HTTPS in production
# 7. Use strong JWT_SECRET (at least 32 characters)
